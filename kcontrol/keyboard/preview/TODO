Important:

Good to have:
* replace symkey2ucs with something more reliable (e.g. XLookupString?)

Cleanup:
* clean up the code (especially kbpreviewframe.cpp)
